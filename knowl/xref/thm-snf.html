<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
</head>
<body class="ignore-math">
<article class="theorem theorem-like"><h4 class="heading">
<span class="type">Theorem</span><span class="space"> </span><span class="codenumber">14.14</span><span class="period">.</span><span class="space"> </span><span class="title">Smith Normal Form.</span>
</h4>
<div class="para logical">
<div class="para">Let <span class="process-math">\(R\)</span> be a Euclidean domain and let <span class="process-math">\(A \in \Mat_{m \times n}(R)\text{.}\)</span> Then there is a sequence of elementary column and column operations that transform <span class="process-math">\(A\)</span> into a matrix <span class="process-math">\(S = [s_{i,j}]\)</span> such that all non-diagonal entries of <span class="process-math">\(S\)</span> are <span class="process-math">\(0\)</span> and the diagonal entries of <span class="process-math">\(S\)</span> satisfy</div>
<div class="displaymath process-math">
\begin{equation*}
s_{1,1} \mid s_{2,2} \mid s_{3,3} \mid \cdots.
\end{equation*}
</div>
</div></article><details class="hiddenproof born-hidden-knowl"><summary class="knowl__link"><h4 class="heading"><span class="type">Proof<span class="period">.</span></span></h4></summary><article class="hiddenproof knowl__content"><div class="para">Before we begin, note that we will apply a sequence of steps that correspond to multiplication by an invertible matrix on the left or right, and by <a href="sec-snf.html#lem-gcd-of-a-matrix-in-pid" class="xref" data-knowl="./knowl/xref/lem-gcd-of-a-matrix-in-pid.html" data-reveal-label="Reveal" data-close-label="Close" title="Lemma 14.20: Matrix GCDs in PIDs">Lemma 14.20</a>, none of these steps will change the gcd.</div> <div class="para logical">
<div class="para">To prove existence of such a matrix <span class="process-math">\(M\text{,}\)</span> we claim we can multiply <span class="process-math">\(A\)</span> on the right and the left by invertible matrices to transform it into a matrix of the form</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/lem-gcd-of-a-matrix-in-pid.html">
\begin{equation*}
\left[\begin{array}{ll} g &amp; 0 \\ 0 &amp; B \end{array}\right] 
\end{equation*}
</div>
<div class="para">for some <span class="process-math">\((n-1) \times(m-1)\)</span> matrix <span class="process-math">\(B\text{,}\)</span> where <span class="process-math">\(g=\operatorname{gcd}(A)\text{.}\)</span> If our claim holds, then we are done: notice that <span class="process-math">\(g\)</span> divides every entry of <span class="process-math">\(B\text{,}\)</span> since <span class="process-math">\(\operatorname{gcd}(A)=\operatorname{gcd}(g, B)\)</span> by <a href="sec-snf.html#lem-gcd-of-a-matrix-in-pid" class="xref" data-knowl="./knowl/xref/lem-gcd-of-a-matrix-in-pid.html" data-reveal-label="Reveal" data-close-label="Close" title="Lemma 14.20: Matrix GCDs in PIDs">Lemma 14.20</a>, and so by applying this fact to <span class="process-math">\(B\text{,}\)</span> and then over and over again, we arrive at a matrix of the desired form <span class="process-math">\(M\text{.}\)</span> Notice moreover that if <span class="process-math">\(C\)</span> is an invertible matrix, then so is</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/lem-gcd-of-a-matrix-in-pid.html">
\begin{equation*}
\left[\begin{array}{ll} 1 &amp; 0 \\ 0 &amp; C \end{array}\right] 
\end{equation*}
</div>
</div> <div class="para logical">
<div class="para">To construct a matrix in the form above, let <span class="process-math">\(a\)</span> be the upper left <span class="process-math">\((1,1)\)</span> entry of <span class="process-math">\(A\text{.}\)</span> First, we are going to show that we can turn <span class="process-math">\(A\)</span> into a matrix of the form</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/lem-gcd-two-by-two.html">
\begin{equation*}
\left[\begin{array}{ll} * &amp; 0 \\ 0 &amp; B \end{array}\right] 
\end{equation*}
</div>
<div class="para">with the same gcd as <span class="process-math">\(A\text{.}\)</span> If a happens to divide all the entries on the first row and column, then we can simply apply elementary row and column operations to get to the desired form. Suppose there exists <span class="process-math">\(b\)</span> on the first column such that <span class="process-math">\(a \nmid b\text{.}\)</span> Then we may apply an elementary row operation switching rows so that <span class="process-math">\(b=a_{2,1}\)</span> is on the first column, second row. By <a href="sec-snf.html#lem-gcd-two-by-two" class="xref" data-knowl="./knowl/xref/lem-gcd-two-by-two.html" data-reveal-label="Reveal" data-close-label="Close" title="Lemma 14.21: Matrix GCD of Ring Elements">Lemma 14.21</a>, we can now find an invertible matrix <span class="process-math">\(C \in \mathrm{M}_{2}(R)\)</span> such that</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/lem-gcd-two-by-two.html">
\begin{equation*}
C\left[\begin{array}{l} a \\ b \end{array}\right] =\left[\begin{array}{c} \operatorname{gcd}(a, b) \\ 0 \end{array}\right] . 
\end{equation*}
</div>
</div> <div class="para logical">
<div class="para">Consider the <span class="process-math">\(m \times m\)</span> matrix</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/lem-gcd-of-a-matrix-in-pid.html">
\begin{equation*}
P:=\left[\begin{array}{cc} C &amp; 0 \\ 0 &amp; I_{m-2} \end{array}\right] . 
\end{equation*}
</div>
<div class="para">Note that <span class="process-math">\(P A\)</span> has <span class="process-math">\((P A)_{1,1}=\operatorname{gcd}(a, b)\)</span> and <span class="process-math">\((P A)_{2,1}=0\text{,}\)</span> so this step replaces <span class="process-math">\(a\)</span> by <span class="process-math">\(\operatorname{gcd}(a, b)\)</span> and <span class="process-math">\(b\)</span> by 0 . By <a href="sec-snf.html#lem-gcd-of-a-matrix-in-pid" class="xref" data-knowl="./knowl/xref/lem-gcd-of-a-matrix-in-pid.html" data-reveal-label="Reveal" data-close-label="Close" title="Lemma 14.20: Matrix GCDs in PIDs">Lemma 14.20</a>, <span class="process-math">\(\operatorname{gcd}(P A)=\operatorname{gcd}(A)\text{.}\)</span> We can keep repeating this until the top left corner entry divides every entry on the first column, and this process must stop after at most <span class="process-math">\(m-1\)</span> steps, since there are only <span class="process-math">\(m\)</span> elements on the first column.</div>
</div> <div class="para logical">
<div class="para">Similarly, if there exists <span class="process-math">\(b\)</span> on the first row that <span class="process-math">\(a\)</span> does not divide, we can repeat this process by instead multiplying <span class="process-math">\(A\)</span> on the left by an invertible matrix, until we zero out all the remaining entries on the first row and column. Finally, we arrive at a matrix of the form</div>
<div class="displaymath process-math">
\begin{equation*}
\left[\begin{array}{ll} a &amp; 0 \\ 0 &amp; B \end{array}\right] 
\end{equation*}
</div>
</div> <div class="para">If <span class="process-math">\(a=\operatorname{gcd}(A)\text{,}\)</span> we are done. If not, then we can find some entry <span class="process-math">\(b=a_{i, j}\)</span> such that <span class="process-math">\(a \nmid b\text{.}\)</span> We can then add the <span class="process-math">\(j\)</span> th column to the first column, which puts <span class="process-math">\(b\)</span> into the first column without affecting <span class="process-math">\(a\text{,}\)</span> since the remainder of the top row is zero. But this brings us back to the previous situation, and we have already shown that we can replace the top left corner by <span class="process-math">\(\operatorname{gcd}(a, b)\text{.}\)</span>
</div> <div class="para logical">
<div class="para">At each step, we replace <span class="process-math">\(a\)</span> by some <span class="process-math">\(c\)</span> with is both a divisor of <span class="process-math">\(a\)</span> and a multiple of <span class="process-math">\(\operatorname{gcd}(A)\text{.}\)</span> Our ring <span class="process-math">\(R\)</span> is a UFD, so there are finitely many factors of <span class="process-math">\(a / \operatorname{gcd}(A)\text{,}\)</span> and this process must stop. This shows that we can eventually replace <span class="process-math">\(A\)</span> by</div>
<div class="displaymath process-math">
\begin{equation*}
\left[\begin{array}{cc} \operatorname{gcd}(A) &amp; 0 \\ 0 &amp; B \end{array}\right]. 
\end{equation*}
</div>
</div> <div class="para">Now it remains to show the uniqueness portion of the theorem. For any <span class="process-math">\(i\)</span> and any matrix <span class="process-math">\(B\text{,}\)</span> let <span class="process-math">\(\operatorname{gcd}_{i}(B)\)</span> denote the gcd of all the <span class="process-math">\(i \times i\)</span> minors of <span class="process-math">\(B\text{.}\)</span> By <a href="sec-snf.html#lem-ideals-generated-by-minors" class="xref" data-knowl="./knowl/xref/lem-ideals-generated-by-minors.html" data-reveal-label="Reveal" data-close-label="Close" title="Lemma 14.23: Ideals Generated by Minors">Lemma 14.23</a>, <span class="process-math">\(\operatorname{gcd}_{i}\)</span> is unchanged by row and column operations, so <span class="process-math">\(\gcd_i(A) = \gcd_i(M )\text{.}\)</span>
</div> <div class="para logical">
<div class="para">For a matrix of the form <span class="process-math">\(M\text{,}\)</span> the only minors that are nonzero are those where the choices of columns and rows are the same, and hence the only nonzero <span class="process-math">\(i \times i\)</span> minors of <span class="process-math">\(M\)</span> are <span class="process-math">\(g_{s_{1}} \cdots g_{s_{i}}\)</span> for some <span class="process-math">\(s_{1}&lt;\cdots&lt;s_{i}\text{.}\)</span> Since <span class="process-math">\(g_{s_{1}} \cdots g_{s_{i}}\)</span> divide each other, it follows that</div>
<div class="displaymath process-math">
\begin{equation*}
\operatorname{gcd}_{i}(A)=\operatorname{gcd}_{i}(M)=g_{1} \cdots g_{i} .
\end{equation*}
</div>
</div> <div class="para logical">
<div class="para">In particular, the largest value of <span class="process-math">\(i\)</span> such that some <span class="process-math">\(i \times i\)</span> minor of <span class="process-math">\(A\)</span> is nonzero is <span class="process-math">\(\ell\text{.}\)</span> Also, we have</div>
<div class="displaymath process-math">
\begin{equation*}
g_{i}=\frac{\operatorname{gcd}_{i}(A)}{\operatorname{gcd}_{i-1}(A)} .
\end{equation*}
</div>
</div> <div class="para">This proves uniqueness, for it shows that <span class="process-math">\(\ell, g_{1}, \ldots, g_{\ell}\)</span> are all defined from <span class="process-math">\(A\)</span> directly, without any choices.</div></article></details><span class="incontext"><a class="internal" href="sec-snf.html#thm-snf">in-context</a></span>
</body>
</html>
